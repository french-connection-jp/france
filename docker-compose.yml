version: '3.3'
services:
  hamapp:
    build: ./hamapp
    volumes:
      - ./hamapp/log:/var/log/hamcco
    env_file:
      - ./userlocal.env
  upapp:
    build: ./upapp
    volumes:
      - ./upapp/data:/usr/src/app/data
    env_file:
      - ./uploader.env
  glapp:
    build: ./glapp
    volumes:
      - sockets:/usr/src/app/tmp/sockets
      - ./glapp/volume/database:/usr/src/app/database
      - ./glapp/volume/log:/usr/src/app/log
      - ./glapp/volume/uploads:/usr/src/app/public/uploads
  llapp:
    build: ./llapp
    volumes:
      - sockets:/var/tmp/sockets
      - ./llapp/volume/db:/code/sitebase/db
      - ./llapp/volume/log:/var/log/uwsgi
      - ./llapp/volume/llwork:/llwork
  fraweb:
    build: ./fraweb
    ports:
      - "80:80"
      - "443:443"
    links:
      - hamapp:hamapp
      - upapp:upapp
    volumes:
      - sockets:/var/tmp/sockets
      - ./fraweb/log:/var/log/nginx
      - /etc/letsencrypt:/etc/letsencrypt
volumes:
  sockets:
